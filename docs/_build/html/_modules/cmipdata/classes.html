<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cmipdata.classes &mdash; cmipdata 0.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="cmipdata 0.0 documentation" href="../../index.html" />
    <link rel="up" title="cmipdata" href="../cmipdata.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">cmipdata 0.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../cmipdata.html" accesskey="U">cmipdata</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for cmipdata.classes</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;classes</span>
<span class="sd">======================</span>

<span class="sd">Summary</span>
<span class="sd">-------</span>

<span class="sd">The core functionality of cmipdata is to organize a large number of</span>
<span class="sd">model output files into a logical structure so that further processing</span>
<span class="sd">can be done. Data is organized into Ensembles, which are made up of many</span>
<span class="sd">Models, Experiments, Realizations and Variables and filenames. The structure treats </span>
<span class="sd">`Variable`s as the lowest organizing theme. Each Variable contains a list of filenames </span>
<span class="sd">(and other attributes), and each variable belongs</span>
<span class="sd">to a specified Realiation. Each Realization in turn belongs to a specified</span>
<span class="sd">Experiment, which will belong to a given Model.  </span>
<span class="sd">  </span>
<span class="sd">Various methods exist to interact with the Ensemble, and its constituent</span>
<span class="sd">elements. Once created, an Ensemble can be used to harness the power of</span>
<span class="sd">the `preprocessing_tools` to apply systematic operations to all files.</span>
<span class="sd">Indeed, all data-handling and processing in cmipdata used the Ensemble.</span>

<span class="sd">See Also</span>
<span class="sd">--------</span>
<span class="sd"> - preprocessing_tools</span>
<span class="sd"> - loading_tools</span>
<span class="sd"> - plotting_tools</span>
<span class="sd">  </span>
<span class="sd">Examples</span>
<span class="sd">-----------</span>

<span class="sd">A cmipdata Ensemble is easily created using:: </span>

<span class="sd">    ens = cmipdata.mk_ensemble(filepattern) </span>

<span class="sd">which generates the Ensemble `ens`, with all the underlying</span>
<span class="sd">structure, simply by matching all files matching the descriptor</span>
<span class="sd">`filepattern`.</span>

<span class="sd">A summary of the Ensemble can then be generated using::</span>

<span class="sd">    ens.sinfo()</span>
<span class="sd">    </span>
<span class="sd">and a full description of the Ensemble can be gained from::</span>

<span class="sd">    ens.fulldetails()</span>

<span class="sd">.. moduleauthor:: Neil Swart &lt;neil.swart@ec.gc.ca&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">copy</span>

<div class="viewcode-block" id="Ensemble"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble">[docs]</a><span class="k">class</span> <span class="nc">Ensemble</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Defines a cmipdata Ensemble. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    models : list</span>
<span class="sd">             The list of constituent models</span>
<span class="sd">             </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>    
        
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;Models in </span><span class="si">%s</span><span class="s">: </span><span class="se">\n</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">]))</span>
        
<div class="viewcode-block" id="Ensemble.add_model"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.add_model">[docs]</a>    <span class="k">def</span> <span class="nf">add_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Add model to the ensemble</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	model : cmipdata Model</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Ensemble.del_model"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.del_model">[docs]</a>    <span class="k">def</span> <span class="nf">del_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Delete model from the ensemble</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	model : cmipdata Model		</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>     
        </div>
<div class="viewcode-block" id="Ensemble.get_model"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.get_model">[docs]</a>    <span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return modelname from the ensemble</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	modelname : str</span>
<span class="sd">	            The name of the model to return</span>
<span class="sd">	            </span>
<span class="sd">	Returns </span>
<span class="sd">	-------</span>
<span class="sd">	model : cmipdata Model</span>
<span class="sd">	        The Model object corresponding to </span>
<span class="sd">	        modelname</span>
<span class="sd">    </span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
	    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">modelname</span><span class="p">:</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">model</span>
		<span class="k">break</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">m</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">return</span> <span class="n">m</span>
</div>
<div class="viewcode-block" id="Ensemble.iterate"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.iterate">[docs]</a>    <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Returns a iterable, which is a tuple containing all the ensembles </span>
<span class="sd">	model, experiment, realization and variable objects and the list of filenames.</span>
<span class="sd">	</span>
<span class="sd">	EXAMPLE::</span>
<span class="sd">	</span>
<span class="sd">       for model, experiment, realization, variable, files in ens.iterate():</span>
<span class="sd">           print model.name, experiment.name, realization.name, variable.name, files		</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
	    <span class="k">for</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">experiments</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">realization</span> <span class="ow">in</span> <span class="n">experiment</span><span class="o">.</span><span class="n">realizations</span><span class="p">:</span>
		    <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">realization</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
			<span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">realization</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">variable</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span> <span class="p">)</span>
			
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>			
			</div>
<div class="viewcode-block" id="Ensemble.squeeze"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.squeeze">[docs]</a>    <span class="k">def</span> <span class="nf">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Remove any empty elements from the ensemble</span>
<span class="sd">	WARNING: since ens is modifying itself in the loop, something could go wrong!</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">realization</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterate</span><span class="p">():</span>
	    <span class="n">realization</span><span class="o">.</span><span class="n">del_variable</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span> <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">filenames</span> <span class="o">==</span> <span class="p">[]</span> <span class="k">else</span> <span class="mi">0</span> <span class="c"># if the variable contains no files delete it</span>
   	    <span class="n">experiment</span><span class="o">.</span><span class="n">del_realization</span><span class="p">(</span><span class="n">realization</span><span class="p">)</span> <span class="k">if</span> <span class="n">realization</span><span class="o">.</span><span class="n">variables</span> <span class="o">==</span> <span class="p">[]</span> <span class="k">else</span> <span class="mi">0</span> <span class="c"># if the realization contains no variables delete it</span>
   	    <span class="n">model</span><span class="o">.</span><span class="n">del_experiment</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span> <span class="k">if</span> <span class="n">experiment</span><span class="o">.</span><span class="n">realizations</span> <span class="o">==</span> <span class="p">[]</span> <span class="k">else</span> <span class="mi">0</span> <span class="c"># if the experiment contains no realizations delete it</span>
   	    <span class="bp">self</span><span class="o">.</span><span class="n">del_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">experiments</span> <span class="o">==</span> <span class="p">[]</span> <span class="k">else</span> <span class="mi">0</span> <span class="c"># if the model contains no experiments delete it</span>

   	<span class="k">return</span> <span class="bp">self</span>
   	    </div>
<div class="viewcode-block" id="Ensemble.models"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.models">[docs]</a>    <span class="k">def</span> <span class="nf">models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Retuns the list of model objects in the ensemble&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</div>
<div class="viewcode-block" id="Ensemble.num_models"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.num_models">[docs]</a>    <span class="k">def</span> <span class="nf">num_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Returns the number of models in the ensemble&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Ensemble.sinfo"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.sinfo">[docs]</a>    <span class="k">def</span> <span class="nf">sinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Returns the number of models, experiments, realizations, variables and files </span>
<span class="sd">	in the ensemble&quot;&quot;&quot;</span>
        <span class="n">realizations</span><span class="o">=</span><span class="p">[]</span> <span class="p">;</span> <span class="n">experiments</span><span class="o">=</span><span class="p">[];</span> <span class="n">variables</span><span class="o">=</span><span class="p">[];</span> <span class="n">files</span><span class="o">=</span><span class="p">[]</span>
      	<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
	    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">experiments</span><span class="p">:</span>
		<span class="n">experiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
         	<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">realizations</span><span class="p">:</span>
                    <span class="n">realizations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
		    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
			<span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
		        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">filenames</span><span class="p">:</span>
			    <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="n">rstring</span> <span class="o">=</span> <span class="s">&quot;This ensemble contains:</span><span class="se">\n</span><span class="s"> </span><span class="si">%s</span><span class="s"> models </span><span class="se">\n</span><span class="s"> </span><span class="si">%s</span><span class="s"> realizations </span><span class="se">\n</span><span class="s"> </span><span class="si">%s</span><span class="s"> experiments </span><span class="se">\n</span><span class="s"> </span><span class="si">%s</span><span class="s"> variables </span><span class="se">\n</span><span class="s"> </span><span class="si">%s</span><span class="s"> associated files&quot;</span>\
            <span class="o">%</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">realizations</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">experiments</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="p">)</span> 		
                 
        <span class="k">print</span> <span class="n">rstring</span>        
       
    </div>
<div class="viewcode-block" id="Ensemble.fulldetails"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Ensemble.fulldetails">[docs]</a>    <span class="k">def</span> <span class="nf">fulldetails</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; prints information about the number of models, experiments and realizations in an ensemble&quot;&quot;&quot;</span>
	<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
	    <span class="k">print</span> <span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span><span class="s">&#39;:&#39;</span>
	    <span class="k">for</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">experiments</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">experiment</span><span class="o">.</span><span class="n">name</span>
		<span class="k">for</span> <span class="n">realization</span> <span class="ow">in</span> <span class="n">experiment</span><span class="o">.</span><span class="n">realizations</span><span class="p">:</span>
		    <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">realization</span><span class="o">.</span><span class="n">name</span>
	            <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">realization</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
		        <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t\t\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">variable</span><span class="o">.</span><span class="n">name</span>
			<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">variable</span><span class="o">.</span><span class="n">filenames</span><span class="p">:</span>
			    <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t\t\t\t</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">filename</span>     
                </div></div>
<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Defines a model with a name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modelname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">modelname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span> <span class="o">=</span> <span class="p">[]</span>
               
<div class="viewcode-block" id="Model.add_experiment"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Model.add_experiment">[docs]</a>    <span class="k">def</span> <span class="nf">add_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Adds the experiment object experiment to the </span>
<span class="sd">	models experiments</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Model.del_experiment"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Model.del_experiment">[docs]</a>    <span class="k">def</span> <span class="nf">del_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;deletes the experiment object experiment from the </span>
<span class="sd">	models experiments</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Model.get_experiment"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Model.get_experiment">[docs]</a>    <span class="k">def</span> <span class="nf">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experimentname</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Finds and returns the experiment object corresponding</span>
<span class="sd">	to experimnentname in the model experiment list, or if no </span>
<span class="sd">	match is found, returns an empty list.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">for</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="p">:</span>
	    <span class="k">if</span> <span class="n">experiment</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">experimentname</span><span class="p">:</span>
		<span class="n">e</span> <span class="o">=</span> <span class="n">experiment</span>
		<span class="k">break</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">return</span> <span class="n">e</span>    
    </div>
    <span class="k">def</span> <span class="nf">experiments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span> 
        
<div class="viewcode-block" id="Model.num_experiments"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Model.num_experiments">[docs]</a>    <span class="k">def</span> <span class="nf">num_experiments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Returns the number of experiments defined for the model&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="p">)</span>     
</div></div>
<div class="viewcode-block" id="Experiment"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Experiment">[docs]</a><span class="k">class</span> <span class="nc">Experiment</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Defines an experiment for a given model, with a name and a list of</span>
<span class="sd">    assiciated realizations, which can be retrieved with</span>
<span class="sd">    experiment.realizations(). New realizations can be added</span>
<span class="sd">    to the experiment with experiment.add_realization(realization)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experimentname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">experimentname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realizations</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        
<div class="viewcode-block" id="Experiment.add_realization"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Experiment.add_realization">[docs]</a>    <span class="k">def</span> <span class="nf">add_realization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">realization</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Adds the realization object experiment to the </span>
<span class="sd">	experiments realizations.</span>
<span class="sd">	&quot;&quot;&quot;</span>	
        <span class="bp">self</span><span class="o">.</span><span class="n">realizations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">realization</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Experiment.del_realization"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Experiment.del_realization">[docs]</a>    <span class="k">def</span> <span class="nf">del_realization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">realization</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Adds the realization object experiment to the </span>
<span class="sd">	experiments realizations.</span>
<span class="sd">	&quot;&quot;&quot;</span>	
        <span class="bp">self</span><span class="o">.</span><span class="n">realizations</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">realization</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Experiment.get_realization"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Experiment.get_realization">[docs]</a>    <span class="k">def</span> <span class="nf">get_realization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">realizationname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds and returns the realization object corresponding</span>
<span class="sd">	to realizationname in the experiment&#39;s realization list, or if no </span>
<span class="sd">	match is found, returns an empty list.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">for</span> <span class="n">realization</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">realizations</span><span class="p">:</span>
	    <span class="k">if</span> <span class="n">realization</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">realizationname</span><span class="p">:</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">realization</span>
		<span class="k">break</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">return</span> <span class="n">r</span>            
        </div>
    <span class="k">def</span> <span class="nf">realizations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">realizations</span>     
        
<div class="viewcode-block" id="Experiment.num_realizations"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Experiment.num_realizations">[docs]</a>    <span class="k">def</span> <span class="nf">num_realizations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Returns the number of realizations defined for the </span>
<span class="sd">	experiment instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">realizations</span><span class="p">)</span>  
        </div></div>
<div class="viewcode-block" id="Realization"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Realization">[docs]</a><span class="k">class</span> <span class="nc">Realization</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Defines a realization for a given model and experiment, </span>
<span class="sd">    with a name and a list of</span>
<span class="sd">    assiciated variables, which can be retrieved with</span>
<span class="sd">    realization.variables(). New variables can be added</span>
<span class="sd">    to the realization with realization.add_variable(variable)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">realizationname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">realizationname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="p">[]</span>
        
<div class="viewcode-block" id="Realization.add_variable"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Realization.add_variable">[docs]</a>    <span class="k">def</span> <span class="nf">add_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Adds the variable object to the </span>
<span class="sd">	realization&#39;s variables.</span>
<span class="sd">	&quot;&quot;&quot;</span>	
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Realization.del_variable"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Realization.del_variable">[docs]</a>    <span class="k">def</span> <span class="nf">del_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Delete the variable object to the </span>
<span class="sd">	realization&#39;s variables.</span>
<span class="sd">	&quot;&quot;&quot;</span>	
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Realization.get_variable"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Realization.get_variable">[docs]</a>    <span class="k">def</span> <span class="nf">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variablename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds and returns the variable object corresponding</span>
<span class="sd">	to variablename in the realization&#39;s variable list, or if no </span>
<span class="sd">	match is found, returns an empty list.</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
	    <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">variablename</span><span class="p">:</span>
		<span class="n">v</span> <span class="o">=</span> <span class="n">variable</span>
		<span class="k">break</span>
	<span class="k">else</span><span class="p">:</span>
	    <span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">return</span> <span class="n">v</span>
	</div>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span>
        
<div class="viewcode-block" id="Realization.num_variables"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Realization.num_variables">[docs]</a>    <span class="k">def</span> <span class="nf">num_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Returns the number of variables defined for the </span>
<span class="sd">	realization instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">realizations</span><span class="p">)</span>
        </div></div>
<div class="viewcode-block" id="Variable"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Variable">[docs]</a><span class="k">class</span> <span class="nc">Variable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Defines a variable for a given model, experiment and realization,</span>
<span class="sd">    with a name, and an associated list of filenames, which can be retrieved </span>
<span class="sd">    with variable.filenames(). A new filename can be added with </span>
<span class="sd">    variable.add_filename(&#39;filename.nc&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variablename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">variablename</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_dates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_dates</span> <span class="o">=</span> <span class="p">[]</span>
        
<div class="viewcode-block" id="Variable.add_filename"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Variable.add_filename">[docs]</a>    <span class="k">def</span> <span class="nf">add_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Adds filname to the variable&#39;s list of files&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Variable.del_filename"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Variable.del_filename">[docs]</a>    <span class="k">def</span> <span class="nf">del_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Removes a filname from the variable&#39;s list of files&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Variable.add_realm"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Variable.add_realm">[docs]</a>    <span class="k">def</span> <span class="nf">add_realm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">realm</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Adds realm to the variable&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realm</span> <span class="o">=</span> <span class="n">realm</span>  
        </div>
<div class="viewcode-block" id="Variable.add_start_date"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Variable.add_start_date">[docs]</a>    <span class="k">def</span> <span class="nf">add_start_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_date</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Adds start_dates to the variable&#39;s list of file start-dates&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span>  
        </div>
<div class="viewcode-block" id="Variable.add_end_date"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Variable.add_end_date">[docs]</a>    <span class="k">def</span> <span class="nf">add_end_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Adds end_date to the variable&#39;s list of file end-dates&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span> 
        </div>
<div class="viewcode-block" id="Variable.filenames"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Variable.filenames">[docs]</a>    <span class="k">def</span> <span class="nf">filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Retuns a list of filenames associated with the variable&quot;&quot;&quot;</span>	
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span>
        </div>
<div class="viewcode-block" id="Variable.num_files"><a class="viewcode-back" href="../../api.html#cmipdata.classes.Variable.num_files">[docs]</a>    <span class="k">def</span> <span class="nf">num_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Returns the number of files listed for the </span>
<span class="sd">        variable instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>        
   </div></div>
<div class="viewcode-block" id="mkensemble"><a class="viewcode-back" href="../../api.html#cmipdata.classes.mkensemble">[docs]</a><span class="k">def</span> <span class="nf">mkensemble</span><span class="p">(</span><span class="n">filepattern</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="s">&#39;*&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates and returns a cmipdata ensemble object from a list of </span>
<span class="sd">    filenames matching filepattern. </span>
<span class="sd">    </span>
<span class="sd">    Once the list of matching filenames is derived, the model, experiment,</span>
<span class="sd">    realization, variable, start_date and end_date fields are extracted by</span>
<span class="sd">    parsing the filnames against a specified file naming convention. By </span>
<span class="sd">    default this is the CMIP5 convention, which is::</span>
<span class="sd">    </span>
<span class="sd">        variable_realm_model_experiment_realization_startdate-enddate.nc</span>
<span class="sd">    </span>
<span class="sd">    Optionally specifying prefix will remove prefix from each filename</span>
<span class="sd">    before the parsing is done. This is useful, for example, to remove </span>
<span class="sd">    pre-pended paths used in filepattern.</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    filepattern : string  </span>
<span class="sd">                A string that by default is matched against all files in the </span>
<span class="sd">                current directory. But filepattern could include a full path </span>
<span class="sd">                to reference files not in the current directory, and can also </span>
<span class="sd">                include wildcards. </span>
<span class="sd">                </span>
<span class="sd">    prefix : string</span>
<span class="sd">             A pattern occuring in filepattern before the start of the official</span>
<span class="sd">             filename, as defined by the file naming converntion. For instance,</span>
<span class="sd">             a path preceeding the filename.</span>
<span class="sd">    </span>
<span class="sd">    EXAMPLES</span>
<span class="sd">    --------</span>
<span class="sd">    </span>
<span class="sd">    1. Create ensemble of all sea-level pressure files from the historical experiment in </span>
<span class="sd">    the current directory::</span>
<span class="sd">    </span>
<span class="sd">        ens = mkensemble(&#39;psl*historical*.nc&#39;) </span>
<span class="sd">          </span>
<span class="sd">    2. Create ensemble of all sea-level pressure files from all experiments in a non-local</span>
<span class="sd">    directory::</span>
<span class="sd">    </span>
<span class="sd">        ens = mkensemble(&#39;/home/ncs/ra40/cmip5/sam/c5_slp/psl*&#39;</span>
<span class="sd">                      , prefix=&#39;/home/ncs/ra40/cmip5/sam/c5_slp/&#39;) </span>

<span class="sd">    </span>
<span class="sd">    If the default CMIP5 naming convention is not used by your files,</span>
<span class="sd">    an arbitary naming convention for the parsing may be specified by</span>
<span class="sd">    kwargs. kwargs is a dictionary whos keys contain each element (model, </span>
<span class="sd">    experiment,realization, variable, start_date and end_date) and</span>
<span class="sd">    whos values are the position in the filename that the element occurs.</span>
<span class="sd">    In addition, the key &#39;separator&#39; must contain the element separator.</span>
<span class="sd">    For example, for the CMIP5 naming convention::</span>
<span class="sd">    </span>
<span class="sd">        kwargs = {&#39;separator&#39;:&#39;_&#39;, &#39;variable&#39;:0, &#39;realm&#39;:1, &#39;model&#39;:2, &#39;experiment&#39;:3,</span>
<span class="sd">                  &#39;realization&#39;:4, &#39;dates&#39;:5}</span>
<span class="sd">    </span>
<span class="sd">        ens = mkensemble(&#39;psl*.nc&#39;, **kwargs) </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
 
    <span class="c"># find all files matching filepattern</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span> <span class="n">filepattern</span> <span class="p">)</span> <span class="p">)</span>
   
    <span class="k">if</span> <span class="n">kwargs</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;separator&#39;</span><span class="p">:</span><span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;realm&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;model&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;experiment&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                  <span class="s">&#39;realization&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s">&#39;dates&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>

    <span class="c"># Initialize the ensemble object</span>
    <span class="n">ens</span> <span class="o">=</span> <span class="n">Ensemble</span><span class="p">()</span>
                  
    <span class="c"># Loop over all files and </span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
	<span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
	<span class="n">variablename</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;separator&#39;</span><span class="p">]</span> <span class="p">)[</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;variable&#39;</span><span class="p">]</span> <span class="p">]</span>
	<span class="n">realm</span>        <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;separator&#39;</span><span class="p">]</span> <span class="p">)[</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;realm&#39;</span><span class="p">]</span> <span class="p">]</span>
	<span class="n">modelname</span>    <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;separator&#39;</span><span class="p">]</span> <span class="p">)[</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;model&#39;</span><span class="p">]</span> <span class="p">]</span>
	<span class="n">experiment</span>   <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;separator&#39;</span><span class="p">]</span> <span class="p">)[</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;experiment&#39;</span><span class="p">]</span> <span class="p">]</span>
	<span class="n">realization</span>  <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;separator&#39;</span><span class="p">]</span> <span class="p">)[</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;realization&#39;</span><span class="p">]</span> <span class="p">]</span>
	<span class="n">dates</span>        <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;separator&#39;</span><span class="p">]</span> <span class="p">)[</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;dates&#39;</span><span class="p">]</span> <span class="p">]</span>
	<span class="n">start_date</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;separator&#39;</span><span class="p">]</span> <span class="p">)[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
	<span class="n">end_date</span>     <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;separator&#39;</span><span class="p">]</span> <span class="p">)[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
	
	<span class="c"># create the model if necessary</span>
	<span class="n">m</span> <span class="o">=</span> <span class="n">ens</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">modelname</span><span class="p">)</span>   
	<span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="p">[]:</span>
	    <span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">modelname</span><span class="p">)</span>
	    <span class="n">ens</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
	    
	<span class="c"># create the experiment if necessary    </span>
	<span class="n">e</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">e</span> <span class="o">==</span> <span class="p">[]:</span>
	    <span class="n">e</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
	    <span class="n">m</span><span class="o">.</span><span class="n">add_experiment</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
	    
	<span class="c">#create the realization if necessary</span>
	<span class="n">r</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_realization</span><span class="p">(</span><span class="n">realization</span><span class="p">)</span>   
	<span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="p">[]:</span>
	    <span class="n">r</span> <span class="o">=</span> <span class="n">Realization</span><span class="p">(</span><span class="n">realization</span><span class="p">)</span>
            <span class="n">e</span><span class="o">.</span><span class="n">add_realization</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
		  
        <span class="c"># create the variable if necessary    </span>
	<span class="n">v</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="n">variablename</span><span class="p">)</span>   
	<span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="p">[]:</span>
	    <span class="n">v</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">variablename</span><span class="p">)</span>
	    <span class="n">v</span><span class="o">.</span><span class="n">add_realm</span><span class="p">(</span><span class="n">realm</span><span class="p">)</span>
	    <span class="n">r</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
			
	<span class="c"># Add the filename to the variable list</span>
	<span class="n">v</span><span class="o">.</span><span class="n">add_filename</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
	<span class="n">v</span><span class="o">.</span><span class="n">add_start_date</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span>
	<span class="n">v</span><span class="o">.</span><span class="n">add_end_date</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span>
	
    <span class="n">ens</span><span class="o">.</span><span class="n">sinfo</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s"> For more details use ens.fulldetails() </span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ens</span>    
    

 
		    </div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">cmipdata 0.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../cmipdata.html" >cmipdata</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Neil Swart.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>